<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Parametric Bootstrap of an MGPM â€¢ PCMFit</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Parametric Bootstrap of an MGPM">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-129563006-6"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129563006-6');
</script>
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">PCMFit</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/pcmfit.html">Get started</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/pcmfitmixed.html">Inferring an MGPM with Unknown Shifts</a>
    </li>
    <li>
      <a href="../articles/parambootstrap.html">Parametric Bootstrap</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Parametric Bootstrap of an MGPM</h1>
                        <h4 class="author">Venelin Mitov</h4>
            
            <h4 class="date">2019-12-30</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/venelin/PCMFit/blob/master/vignettes/parambootstrap.Rmd"><code>vignettes/parambootstrap.Rmd</code></a></small>
      <div class="hidden name"><code>parambootstrap.Rmd</code></div>

    </div>

    
    
<p><strong>Note:</strong> <em>The writing of this vignette is currently in progress. Please, contact the author for assistance, in case you need to use PCMFit immediately and cannot find your way through the coding examples. Thanks for your understanding.</em></p>
<div id="simulating-parametric-bootstrap-datasets" class="section level1">
<h1 class="hasAnchor">
<a href="#simulating-parametric-bootstrap-datasets" class="anchor"></a>Simulating parametric bootstrap datasets</h1>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="co"># make results reproducible</span></a>
<a class="sourceLine" id="cb1-2" data-line-number="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Random">set.seed</a></span>(<span class="dv">12</span>, <span class="dt">kind =</span> <span class="st">"Mersenne-Twister"</span>, <span class="dt">normal.kind =</span> <span class="st">"Inversion"</span>)</a>
<a class="sourceLine" id="cb1-3" data-line-number="3"></a>
<a class="sourceLine" id="cb1-4" data-line-number="4">numBootstraps &lt;-<span class="st"> </span><span class="dv">10</span></a>
<a class="sourceLine" id="cb1-5" data-line-number="5"></a>
<a class="sourceLine" id="cb1-6" data-line-number="6">bestModel &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb1-7" data-line-number="7"><span class="st">  </span><span class="kw"><a href="../reference/RetrieveBestFitScore.html">RetrieveBestFitScore</a></span>(PCMFitDemoObjects<span class="op">$</span>fitMGPM_A_F_BC2_RR)<span class="op">$</span>inferredModel</a>
<a class="sourceLine" id="cb1-8" data-line-number="8"></a>
<a class="sourceLine" id="cb1-9" data-line-number="9">metaI &lt;-<span class="st"> </span><span class="kw">PCMInfo</span>(</a>
<a class="sourceLine" id="cb1-10" data-line-number="10">  <span class="dt">X =</span> <span class="ot">NULL</span>, <span class="dt">tree =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/attr">attr</a></span>(bestModel, <span class="st">"tree"</span>), <span class="dt">model =</span> bestModel)</a>
<a class="sourceLine" id="cb1-11" data-line-number="11"></a>
<a class="sourceLine" id="cb1-12" data-line-number="12"><span class="co"># Simulate data with the best fit model from the mammal data with SEs</span></a>
<a class="sourceLine" id="cb1-13" data-line-number="13">valuesBootstrapMGPM_A_F_BC2_RR &lt;-<span class="st"> </span><span class="kw">data.table</span>(</a>
<a class="sourceLine" id="cb1-14" data-line-number="14">  <span class="dt">IdGlob =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/seq">seq_len</a></span>(numBootstraps),</a>
<a class="sourceLine" id="cb1-15" data-line-number="15">  <span class="dt">X =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/lapply">lapply</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/seq">seq_len</a></span>(numBootstraps), <span class="cf">function</span>(id) {</a>
<a class="sourceLine" id="cb1-16" data-line-number="16">    <span class="kw">PCMSim</span>(</a>
<a class="sourceLine" id="cb1-17" data-line-number="17">      <span class="dt">tree =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/attr">attr</a></span>(bestModel, <span class="st">"tree"</span>), </a>
<a class="sourceLine" id="cb1-18" data-line-number="18">      <span class="dt">model =</span> bestModel, </a>
<a class="sourceLine" id="cb1-19" data-line-number="19">      <span class="dt">X0 =</span> bestModel<span class="op">$</span>X0,</a>
<a class="sourceLine" id="cb1-20" data-line-number="20">      <span class="dt">metaI =</span> metaI)</a>
<a class="sourceLine" id="cb1-21" data-line-number="21">  })</a>
<a class="sourceLine" id="cb1-22" data-line-number="22">)</a>
<a class="sourceLine" id="cb1-23" data-line-number="23"></a>
<a class="sourceLine" id="cb1-24" data-line-number="24"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/options">options</a></span>(<span class="dt">PCMBase.Value.NA =</span> <span class="fl">-1e20</span>)</a>
<a class="sourceLine" id="cb1-25" data-line-number="25"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/options">options</a></span>(<span class="dt">PCMBase.Lmr.mode =</span> <span class="dv">11</span>)</a>
<a class="sourceLine" id="cb1-26" data-line-number="26"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/options">options</a></span>(<span class="dt">PCMBase.Threshold.EV =</span> <span class="fl">1e-7</span>)</a>
<a class="sourceLine" id="cb1-27" data-line-number="27"></a>
<a class="sourceLine" id="cb1-28" data-line-number="28">valuesBootstrapMGPM_A_F_BC2_RR[</a>
<a class="sourceLine" id="cb1-29" data-line-number="29">  , <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"df"</span>, <span class="st">"logLik"</span>, <span class="st">"score"</span>) <span class="op">:</span><span class="er">=</span><span class="st"> </span>{</a>
<a class="sourceLine" id="cb1-30" data-line-number="30">    resLists &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/lapply">lapply</a></span>(.I, <span class="cf">function</span>(i) {</a>
<a class="sourceLine" id="cb1-31" data-line-number="31">      <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/attr">attr</a></span>(bestModel, <span class="st">"X"</span>) &lt;-<span class="st"> </span>X[[i]]</a>
<a class="sourceLine" id="cb1-32" data-line-number="32">      ll &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/logLik">logLik</a></span>(bestModel)</a>
<a class="sourceLine" id="cb1-33" data-line-number="33">      aic &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/AIC">AIC</a></span>(bestModel)</a>
<a class="sourceLine" id="cb1-34" data-line-number="34">      df &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/attr">attr</a></span>(ll, <span class="st">"df"</span>)</a>
<a class="sourceLine" id="cb1-35" data-line-number="35">      <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(df, ll, aic)</a>
<a class="sourceLine" id="cb1-36" data-line-number="36">    })</a>
<a class="sourceLine" id="cb1-37" data-line-number="37">    <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list">list</a></span>(<span class="dt">df =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/lapply">sapply</a></span>(resLists, <span class="cf">function</span>(.) .[<span class="dv">1</span>]),</a>
<a class="sourceLine" id="cb1-38" data-line-number="38">         <span class="dt">logLik =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/lapply">sapply</a></span>(resLists, <span class="cf">function</span>(.) .[<span class="dv">2</span>]),</a>
<a class="sourceLine" id="cb1-39" data-line-number="39">         <span class="dt">score =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/lapply">sapply</a></span>(resLists, <span class="cf">function</span>(.) .[<span class="dv">3</span>]))</a>
<a class="sourceLine" id="cb1-40" data-line-number="40">  }]</a>
<a class="sourceLine" id="cb1-41" data-line-number="41"></a>
<a class="sourceLine" id="cb1-42" data-line-number="42">PCMFitDemoObjects<span class="op">$</span>valuesBootstrapMGPM_A_F_BC2_RR &lt;-<span class="st"> </span>valuesBootstrapMGPM_A_F_BC2_RR</a>
<a class="sourceLine" id="cb1-43" data-line-number="43">usethis<span class="op">::</span><span class="kw"><a href="https://usethis.r-lib.org/reference/use_data.html">use_data</a></span>(PCMFitDemoObjects, <span class="dt">overwrite =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
</div>
<div id="model-inference-on-the-parametric-bootstrap-datasets" class="section level1">
<h1 class="hasAnchor">
<a href="#model-inference-on-the-parametric-bootstrap-datasets" class="anchor"></a>Model inference on the parametric bootstrap datasets</h1>
<div id="writing-a-parametric-bootstrap-inference-r-script" class="section level2">
<h2 class="hasAnchor">
<a href="#writing-a-parametric-bootstrap-inference-r-script" class="anchor"></a>Writing a parametric bootstrap inference R-script</h2>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="co"># File: FitBootstrap_MGPM_A_F_BC2_RR.R</span></a>
<a class="sourceLine" id="cb2-2" data-line-number="2"><span class="co"># Usage: R --vanilla --slave -f ../../FitBootstrap_MGPM_A_F_BC2_RR.R --args 1</span></a>
<a class="sourceLine" id="cb2-3" data-line-number="3"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(PCMBase)</a>
<a class="sourceLine" id="cb2-4" data-line-number="4"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(PCMBaseCpp)</a>
<a class="sourceLine" id="cb2-5" data-line-number="5"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(PCMFit)</a>
<a class="sourceLine" id="cb2-6" data-line-number="6"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(data.table)</a>
<a class="sourceLine" id="cb2-7" data-line-number="7"></a>
<a class="sourceLine" id="cb2-8" data-line-number="8"><span class="co"># extract dataset identifier and possibly other parameters from the command line:</span></a>
<a class="sourceLine" id="cb2-9" data-line-number="9">args &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/commandArgs">commandArgs</a></span>(<span class="dt">trailingOnly =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb2-10" data-line-number="10"><span class="cf">if</span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(args) <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>) {</a>
<a class="sourceLine" id="cb2-11" data-line-number="11">  data_id &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/integer">as.integer</a></span>(args[<span class="dv">1</span>])</a>
<a class="sourceLine" id="cb2-12" data-line-number="12">} <span class="cf">else</span> {</a>
<a class="sourceLine" id="cb2-13" data-line-number="13">  data_id &lt;-<span class="st"> </span>1L</a>
<a class="sourceLine" id="cb2-14" data-line-number="14">}</a>
<a class="sourceLine" id="cb2-15" data-line-number="15"></a>
<a class="sourceLine" id="cb2-16" data-line-number="16"><span class="co"># A character string used in filenames for a model inference on a given data:</span></a>
<a class="sourceLine" id="cb2-17" data-line-number="17">prefixFiles =<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste0</a></span>(<span class="st">"MGPM_A_F_BC2_RR_BSID_"</span>, data_id)</a>
<a class="sourceLine" id="cb2-18" data-line-number="18"></a>
<a class="sourceLine" id="cb2-19" data-line-number="19"><span class="co"># creating the cluster for this PCMFit run:</span></a>
<a class="sourceLine" id="cb2-20" data-line-number="20"><span class="cf">if</span>(<span class="op">!</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/exists">exists</a></span>(<span class="st">"cluster"</span>) <span class="op">||</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/NULL">is.null</a></span>(cluster)) {</a>
<a class="sourceLine" id="cb2-21" data-line-number="21">  <span class="cf">if</span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">require</a></span>(doMPI)) {</a>
<a class="sourceLine" id="cb2-22" data-line-number="22">    <span class="co"># using MPI cluster as distributed node cluster (possibly running on a </span></a>
<a class="sourceLine" id="cb2-23" data-line-number="23">    <span class="co"># cluster of multiple nodes)</span></a>
<a class="sourceLine" id="cb2-24" data-line-number="24">    <span class="co"># Get the number of cores. Assume this is run in a batch job.</span></a>
<a class="sourceLine" id="cb2-25" data-line-number="25">    p =<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/strtoi">strtoi</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Sys.getenv">Sys.getenv</a></span>(<span class="st">'LSB_DJOB_NUMPROC'</span>))</a>
<a class="sourceLine" id="cb2-26" data-line-number="26">    cluster &lt;-<span class="st"> </span><span class="kw">startMPIcluster</span>(<span class="dt">count =</span> p<span class="dv">-1</span>, <span class="dt">verbose =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb2-27" data-line-number="27">    doMPI<span class="op">::</span><span class="kw">registerDoMPI</span>(cluster)</a>
<a class="sourceLine" id="cb2-28" data-line-number="28">  } <span class="cf">else</span> {</a>
<a class="sourceLine" id="cb2-29" data-line-number="29">    <span class="co"># possibly running on personal computer without mpi installation</span></a>
<a class="sourceLine" id="cb2-30" data-line-number="30">    cluster &lt;-<span class="st"> </span>parallel<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/parallel/topics/makeCluster">makeCluster</a></span>(</a>
<a class="sourceLine" id="cb2-31" data-line-number="31">      parallel<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/parallel/topics/detectCores">detectCores</a></span>(<span class="dt">logical =</span> <span class="ot">TRUE</span>),</a>
<a class="sourceLine" id="cb2-32" data-line-number="32">      <span class="dt">outfile =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste0</a></span>(<span class="st">"log_"</span>, prefixFiles, <span class="st">".txt"</span>))</a>
<a class="sourceLine" id="cb2-33" data-line-number="33">    doParallel<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/doParallel/topics/registerDoParallel">registerDoParallel</a></span>(cluster)</a>
<a class="sourceLine" id="cb2-34" data-line-number="34">  }</a>
<a class="sourceLine" id="cb2-35" data-line-number="35">}</a>
<a class="sourceLine" id="cb2-36" data-line-number="36"></a>
<a class="sourceLine" id="cb2-37" data-line-number="37"><span class="co"># This function is going to be executed on each worker node.</span></a>
<a class="sourceLine" id="cb2-38" data-line-number="38">generatePCMModelsFunction &lt;-<span class="st"> </span><span class="cf">function</span>() {</a>
<a class="sourceLine" id="cb2-39" data-line-number="39">  <span class="co"># make results reproducible</span></a>
<a class="sourceLine" id="cb2-40" data-line-number="40">  <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Random">set.seed</a></span>(<span class="dv">4</span>, <span class="dt">kind =</span> <span class="st">"Mersenne-Twister"</span>, <span class="dt">normal.kind =</span> <span class="st">"Inversion"</span>)</a>
<a class="sourceLine" id="cb2-41" data-line-number="41"></a>
<a class="sourceLine" id="cb2-42" data-line-number="42">  <span class="kw"><a href="http://venelin.github.io/PCMBase/reference/PCMGenerateModelTypes.html">PCMGenerateModelTypes</a></span>()</a>
<a class="sourceLine" id="cb2-43" data-line-number="43">  fileName &lt;-<span class="st"> '../../DefineParameterLimits.R'</span></a>
<a class="sourceLine" id="cb2-44" data-line-number="44">  codeDefineLimits &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/readChar">readChar</a></span>(fileName, <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/file.info">file.info</a></span>(fileName)<span class="op">$</span>size)</a>
<a class="sourceLine" id="cb2-45" data-line-number="45">  <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/eval">eval</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/parse">parse</a></span>(<span class="dt">text =</span> codeDefineLimits), .GlobalEnv)</a>
<a class="sourceLine" id="cb2-46" data-line-number="46">}</a>
<a class="sourceLine" id="cb2-47" data-line-number="47"></a>
<a class="sourceLine" id="cb2-48" data-line-number="48">bestModel &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb2-49" data-line-number="49"><span class="st">  </span><span class="kw"><a href="../reference/RetrieveBestFitScore.html">RetrieveBestFitScore</a></span>(PCMFitDemoObjects<span class="op">$</span>fitMGPM_A_F_BC2_RR)<span class="op">$</span>inferredModel</a>
<a class="sourceLine" id="cb2-50" data-line-number="50"></a>
<a class="sourceLine" id="cb2-51" data-line-number="51">tree &lt;-<span class="st"> </span><span class="kw"><a href="http://venelin.github.io/PCMBase/reference/PCMTree.html">PCMTree</a></span>(PCMFitDemoObjects<span class="op">$</span>dtSimulated<span class="op">$</span>tree[[<span class="dv">1</span>]])</a>
<a class="sourceLine" id="cb2-52" data-line-number="52">X &lt;-<span class="st"> </span>PCMFitDemoObjects<span class="op">$</span>valuesBootstrapMGPM_A_F_BC2_RR<span class="op">$</span>X[[data_id]][</a>
<a class="sourceLine" id="cb2-53" data-line-number="53">  , <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/seq">seq_len</a></span>(<span class="kw"><a href="http://venelin.github.io/PCMBase/reference/PCMTreeNumTips.html">PCMTreeNumTips</a></span>(tree))]</a>
<a class="sourceLine" id="cb2-54" data-line-number="54"></a>
<a class="sourceLine" id="cb2-55" data-line-number="55">currentResultFile &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste0</a></span>(<span class="st">"CurrentResults_fits_"</span>, prefixFiles, <span class="st">".RData"</span>)</a>
<a class="sourceLine" id="cb2-56" data-line-number="56"><span class="cf">if</span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/files">file.exists</a></span>(currentResultFile)) {</a>
<a class="sourceLine" id="cb2-57" data-line-number="57">  <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/load">load</a></span>(currentResultFile)</a>
<a class="sourceLine" id="cb2-58" data-line-number="58">  tableFitsPrev &lt;-<span class="st"> </span>listResults<span class="op">$</span>tableFits</a>
<a class="sourceLine" id="cb2-59" data-line-number="59">} <span class="cf">else</span> {</a>
<a class="sourceLine" id="cb2-60" data-line-number="60">  tableFitsPrev &lt;-<span class="st"> </span><span class="ot">NULL</span></a>
<a class="sourceLine" id="cb2-61" data-line-number="61">}</a>
<a class="sourceLine" id="cb2-62" data-line-number="62"></a>
<a class="sourceLine" id="cb2-63" data-line-number="63">fitMGPM_A_F_BC2_RR &lt;-<span class="st"> </span><span class="kw"><a href="../reference/PCMFitMixed.html">PCMFitMixed</a></span>(</a>
<a class="sourceLine" id="cb2-64" data-line-number="64">    <span class="dt">X =</span> X, <span class="dt">tree =</span> tree, <span class="dt">metaIFun =</span> PCMInfoCpp,</a>
<a class="sourceLine" id="cb2-65" data-line-number="65">    <span class="dt">generatePCMModelsFun =</span> generatePCMModelsFunction, </a>
<a class="sourceLine" id="cb2-66" data-line-number="66">    <span class="dt">maxNumRoundRobins =</span> <span class="dv">2</span>, <span class="dt">maxNumPartitionsInRoundRobins =</span> <span class="dv">2</span>,</a>
<a class="sourceLine" id="cb2-67" data-line-number="67">    <span class="dt">tableFitsPrev =</span> tableFitsPrev,</a>
<a class="sourceLine" id="cb2-68" data-line-number="68">    <span class="dt">prefixFiles =</span> prefixFiles,</a>
<a class="sourceLine" id="cb2-69" data-line-number="69">    <span class="dt">doParallel =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb2-70" data-line-number="70"></a>
<a class="sourceLine" id="cb2-71" data-line-number="71"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/save">save</a></span>(fitMGPM_A_F_BC2_RR, <span class="dt">file =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste0</a></span>(<span class="st">"Result_"</span>, prefixFiles, <span class="st">".RData"</span>))</a></code></pre></div>
</div>
<div id="running-the-parametric-bootstrap-inference-script-on-a-cluster" class="section level2">
<h2 class="hasAnchor">
<a href="#running-the-parametric-bootstrap-inference-script-on-a-cluster" class="anchor"></a>Running the parametric bootstrap inference script on a cluster</h2>
<div class="sourceCode" id="cb3"><pre class="sourceCode sh"><code class="sourceCode bash"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="co"># File: FitBootstrap_MGPM_A_F_BC2_RR_bsub.sh</span></a>
<a class="sourceLine" id="cb3-2" data-line-number="2"><span class="co"># Usage: sh FitBootstrap_MGPM_A_F_BC2_RR_bsub.sh</span></a>
<a class="sourceLine" id="cb3-3" data-line-number="3"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Control">for</a></span> <span class="fu">id</span> in <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Quotes">`</a></span><span class="fu">seq</span> 1 1 10<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Quotes">`</a></span></a>
<a class="sourceLine" id="cb3-4" data-line-number="4"><span class="kw">do</span></a>
<a class="sourceLine" id="cb3-5" data-line-number="5"><span class="fu">mkdir</span> -p ResultsBootstrap/MGPM_A_F_BC2_RR_BSID_<span class="va">$id</span></a>
<a class="sourceLine" id="cb3-6" data-line-number="6"><span class="bu">cd</span> ResultsBootstrap/MGPM_A_F_BC2_RR_BSID_<span class="va">$id</span></a>
<a class="sourceLine" id="cb3-7" data-line-number="7"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Control">if</a></span><span class="bu"> [</span> <span class="ot">-f</span> <span class="st">"Result_MGPM_A_F_BC2_RR_BSID_"</span><span class="va">$id</span><span class="st">".RData"</span><span class="bu"> ]</span></a>
<a class="sourceLine" id="cb3-8" data-line-number="8"><span class="kw">then</span></a>
<a class="sourceLine" id="cb3-9" data-line-number="9"><span class="fu">rm</span> MPI*.log</a>
<a class="sourceLine" id="cb3-10" data-line-number="10"><span class="fu">rm</span> Current*.RData</a>
<a class="sourceLine" id="cb3-11" data-line-number="11"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Control">else</a></span></a>
<a class="sourceLine" id="cb3-12" data-line-number="12"><span class="ex">bsub</span> -M 10000 -n 8 -W 3:59 -R ib sh R --vanilla --slave -f ../../FitBootstrap_MGPM_A_F_BC2_RR.R --args <span class="va">$id</span></a>
<a class="sourceLine" id="cb3-13" data-line-number="13"><span class="kw">fi</span></a>
<a class="sourceLine" id="cb3-14" data-line-number="14"><span class="bu">cd</span> ../..</a>
<a class="sourceLine" id="cb3-15" data-line-number="15"><span class="kw">done</span></a></code></pre></div>
</div>
</div>
<div id="collect-bootstrap-results" class="section level1">
<h1 class="hasAnchor">
<a href="#collect-bootstrap-results" class="anchor"></a>Collect bootstrap results</h1>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1">inferredModel &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb4-2" data-line-number="2"><span class="st">  </span><span class="kw"><a href="../reference/RetrieveBestFitScore.html">RetrieveBestFitScore</a></span>(PCMFitDemoObjects<span class="op">$</span>fitMGPM_A_F_BC2_RR)<span class="op">$</span>inferredModel</a>
<a class="sourceLine" id="cb4-3" data-line-number="3">inferredTree &lt;-<span class="st"> </span><span class="kw"><a href="http://venelin.github.io/PCMBase/reference/PCMTree.html">PCMTree</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/attr">attr</a></span>(inferredModel, <span class="st">"tree"</span>))</a>
<a class="sourceLine" id="cb4-4" data-line-number="4"></a>
<a class="sourceLine" id="cb4-5" data-line-number="5">epochsHD &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/seq">seq</a></span>(.<span class="dv">2</span>, <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Extremes">max</a></span>(<span class="kw"><a href="http://venelin.github.io/PCMBase/reference/PCMTreeNodeTimes.html">PCMTreeNodeTimes</a></span>(inferredTree)), </a>
<a class="sourceLine" id="cb4-6" data-line-number="6">                <span class="dt">by =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb4-7" data-line-number="7"></a>
<a class="sourceLine" id="cb4-8" data-line-number="8">bs_MGPM_A_F_BC2_RR &lt;-<span class="st"> </span><span class="kw"><a href="../reference/CollectBootstrapResults.html">CollectBootstrapResults</a></span>(</a>
<a class="sourceLine" id="cb4-9" data-line-number="9">  <span class="dt">resultDir =</span> <span class="st">"ResultsBootstrap"</span>,</a>
<a class="sourceLine" id="cb4-10" data-line-number="10">  <span class="dt">prefixFiles =</span> <span class="st">"MGPM_A_F_BC2_RR_BSID_"</span>,</a>
<a class="sourceLine" id="cb4-11" data-line-number="11">  <span class="dt">nameFitObject =</span> <span class="st">'fitMGPM_A_F_BC2_RR'</span>,</a>
<a class="sourceLine" id="cb4-12" data-line-number="12">  <span class="dt">ids =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/seq">seq_len</a></span>(<span class="dv">10</span>),</a>
<a class="sourceLine" id="cb4-13" data-line-number="13">  <span class="dt">inferredTree =</span> inferredTree,</a>
<a class="sourceLine" id="cb4-14" data-line-number="14">  <span class="dt">epochs =</span> epochsHD,</a>
<a class="sourceLine" id="cb4-15" data-line-number="15">  <span class="dt">minLength =</span> <span class="fl">0.2</span>,</a>
<a class="sourceLine" id="cb4-16" data-line-number="16">  <span class="dt">verbose =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
</div>
<div id="references" class="section level1">
<h1 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h1>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#simulating-parametric-bootstrap-datasets">Simulating parametric bootstrap datasets</a></li>
      <li>
<a href="#model-inference-on-the-parametric-bootstrap-datasets">Model inference on the parametric bootstrap datasets</a><ul class="nav nav-pills nav-stacked">
<li><a href="#writing-a-parametric-bootstrap-inference-r-script">Writing a parametric bootstrap inference R-script</a></li>
      <li><a href="#running-the-parametric-bootstrap-inference-script-on-a-cluster">Running the parametric bootstrap inference script on a cluster</a></li>
      </ul>
</li>
      <li><a href="#collect-bootstrap-results">Collect bootstrap results</a></li>
      <li><a href="#references">References</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Venelin Mitov.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
